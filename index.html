<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TR·ª¢ L√ù AI H·ªñ TR·ª¢ X·∫æP H·ªòP QU√Ä</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              brand: {
                50: '#eff6ff',
                100: '#dbeafe',
                500: '#3b82f6',
                600: '#2563eb',
                700: '#1d4ed8',
                900: '#1e3a8a',
              },
              purple: {
                50: '#faf5ff',
                100: '#f3e8ff',
                600: '#9333ea',
              }
            }
          }
        }
      }
    </script>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
      body { font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; }
      ::-webkit-scrollbar { width: 6px; }
      ::-webkit-scrollbar-track { background: #f1f5f9; }
      ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
      ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
      /* Hide arrows/spinners for Chrome, Safari, Edge, Opera */
      input::-webkit-outer-spin-button,
      input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }
      /* Firefox */
      input[type=number] {
        -moz-appearance: textfield;
      }
    </style>
  <script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/"
  }
}
</script>
</head>
  <body class="bg-slate-100 text-slate-800 antialiased">
    <div id="root"></div>

    <script type="text/babel">
      // --- ICONS COMPONENT ---
      const Icon = ({ name, className = '', size = 24 }) => {
        const getPath = (name) => {
          switch (name) {
            case 'gift': return <path d="M20 12v10H4V12M2 7h20v5H2V7zm10 0v15M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7zm0 0h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z" />;
            case 'package': return <path d="M16.5 9.4l-9-5.19M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 00 3 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16zM3.27 6.96L12 12.01l8.73-5.05M12 22.08V12" />;
            case 'check': return <path d="M20 6L9 17l-5-5" />;
            case 'sliders': return <path d="M4 21v-7M4 10V3M12 21v-9M12 8V3M20 21v-5M20 12V3M1 14h6M9 8h6M17 16h6" />;
            case 'ruler': return <path d="M2 12.2l1.4-1.4 8 8 1.4-1.4-8-8 1.4-1.4-8-8L12.2 2l9.2 9.2-1.6 1.6-8-8-1.4 1.4 8 8-1.4 1.4-8-8L2 12.2z" />;
            case 'clipboard': return <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2M9 2h6a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1z" />;
            case 'image': return <path d="M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2zm-3.5 7a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zM6 17l4.5-6 2.5 3.5 3.5-5 4.5 7H6z" />;
            case 'youtube': return <path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33zM9.75 15.02l5.75-3.27-5.75-3.27v6.54z" fill="currentColor" />;
            case 'palette': return <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10c.41 0 .75-.34.75-.75 0-.2-.08-.39-.21-.52-.46-.46-.66-1.12-.52-1.76.15-.65.74-1.12 1.41-1.12h1.57c2.76 0 5-2.24 5-5s-2.24-5-5-5zM6.5 10a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm3.5-3a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm3.5 3a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z" />;
            case 'search': return <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />;
            case 'download': return <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3" />;
            case 'shutterstock': return <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 14.5v-5l4 2.5-4 2.5zm1-9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z" />;
            case 'google': return <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z" />;
            case 'pinterest': return <path d="M8 12h8m-8 4h8m-8-8h8" />;
            case 'behance': return <path d="M12 2L2 7l10 5 10-5-10-5zm0 9l2-1 8 4-10 5-10-5 8-4 2 1z" />;
            case 'freepik': return <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />;
            case 'pin': return <path d="M12 2a5 5 0 0 1 5 5c0 4-5 13-5 13S7 11 7 7a5 5 0 0 1 5-5z" />;
            case 'trash': return <g fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2-2v2"/></g>;
            case 'upload': return <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12" />;
            case 'loader': return <path d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83" className="animate-spin origin-center" />;
            case 'box': return <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" />;
            case 'calculator': return <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8zM14 2v6h6M16 13H8M16 17H8M10 9H8" />;
            default: return <path d="M12 2v20M2 12h20" />;
          }
        };

        return (
          <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
            {getPath(name)}
          </svg>
        );
      };

      // --- DATA CONSTANTS ---

      const PRESETS = [
        { id: 'custom', name: 'T·ª± nh·∫≠p s·ªë ƒëo', type: 'RECTANGULAR', dims: { l: 0, w: 0, h: 0 }, weight: 0 },
        { id: 'rubik', name: 'Rubik (Ti√™u chu·∫©n 3x3)', type: 'CUBE', dims: { side: 5.7 }, weight: 100 },
        { id: 'notebook', name: 'S·ªï tay (Kh·ªï A5)', type: 'RECTANGULAR', dims: { l: 21, w: 15, h: 1.5 }, weight: 300 },
        { id: 'thermos', name: 'B√¨nh gi·ªØ nhi·ªát (500ml)', type: 'RECTANGULAR', dims: { l: 7.5, w: 7.5, h: 23 }, weight: 500 },
        { id: 'bear', name: 'G·∫•u b√¥ng nh·ªè (Size 20cm)', type: 'CUBE', dims: { side: 20 }, weight: 200 },
        { id: 'milktea', name: 'Ly tr√† s·ªØa (Size L)', type: 'RECTANGULAR', dims: { l: 9, w: 9, h: 17 }, weight: 600 },
        { id: 'comic', name: 'Truy·ªán tranh (Manga)', type: 'RECTANGULAR', dims: { l: 11.3, w: 17.6, h: 1.5 }, weight: 200 },
        { id: 'keychain', name: 'M√≥c kh√≥a (H·ªôp nh·ªè)', type: 'RECTANGULAR', dims: { l: 6, w: 6, h: 3 }, weight: 50 },
        { id: 'snack', name: 'B√°nh tr√°ng (B·ªãch l·ªõn)', type: 'RECTANGULAR', dims: { l: 22, w: 28, h: 5 }, weight: 150 },
        { id: 'earphone', name: 'Tai nghe (AirPods Box)', type: 'RECTANGULAR', dims: { l: 10, w: 10, h: 4.5 }, weight: 150 },
        { id: 'bracelet', name: 'V√≤ng tay (H·ªôp d·∫πt)', type: 'RECTANGULAR', dims: { l: 9, w: 9, h: 3.5 }, weight: 50 },
      ];

      const OCCASIONS = [
        { id: 'none', label: 'Kh√¥ng c√≥ / Kh√°c', keywords: 'gift box idea' },
        { id: 'bday', label: 'Sinh nh·∫≠t', keywords: 'Happy Birthday Party Surprise' },
        { id: '2011', label: '20/11', keywords: 'Teacher Appreciation Thank You' },
        { id: '83', label: '8/3', keywords: "Mother's Day Teacher Women Sister DIY gift" },
        { id: 'xmas', label: 'Gi√°ng sinh', keywords: 'Christmas Holiday Festive Winter' },
        { id: 'val', label: 'Valentine', keywords: 'Love Heart Boyfriend Girlfriend romantic' },
        { id: 'tet', label: 'T·∫øt', keywords: 'Lunar New Year Spring Festival' },
        { id: 'anniv', label: 'K·ª∑ ni·ªám', keywords: 'Anniversary Memory Love' }
      ];

      const CRITERIA = [
        { id: 'collapsible', label: 'H·ªôp x·∫øp g·ªçn sau khi d√πng', adj: 'folding' },
        { id: 'rigid', label: 'H·ªôp gi·∫•y b√¨a c·ª©ng', adj: 'rigid' },
        { id: 'gable', label: 'H·ªôp c√≥ quai x√°ch', adj: 'gable' },
        { id: 'window', label: 'H·ªôp c√≥ ch·ªó nh√¨n v√†o b√™n trong', adj: 'window' },
        { id: 'eco', label: 'Th√¢n thi·ªán m√¥i tr∆∞·ªùng (√≠t d√πng keo)', adj: 'no glue' }, 
        { id: 'lid_base', label: 'H·ªôp n·∫Øp r·ªùi', adj: 'lid and base' }, 
      ];

      const SHAPES = [
        { id: 'RECTANGULAR', name: 'H·ªôp Ch·ªØ Nh·∫≠t (Rectangular)', keyword: 'rectangular box' },
        { id: 'CUBE', name: 'H·ªôp L·∫≠p Ph∆∞∆°ng (Cube)', keyword: 'cube box' },
        { id: 'TRI_PRISM', name: 'LƒÉng tr·ª• ƒë·ª©ng tam gi√°c', keyword: 'triangle box' }, 
        { id: 'QUAD_PRISM', name: 'LƒÉng tr·ª• ƒë·ª©ng t·ª© gi√°c (ƒë√°y l√† h√¨nh thang)', keyword: 'trapezoid gift box template' },
      ];

      // --- APP COMPONENT ---

      const App = () => {
        // State - INITIALIZED TO 0 TO PREVENT CRASHES
        const [formData, setFormData] = React.useState({
          preset: 'custom',
          occasion: 'none',
          shape: 'RECTANGULAR',
          weight: 0,
          length: 0, width: 0, height: 0,
          side: 0,
          baseEdge1: 0, baseEdge2: 0, baseEdge3: 0, baseEdge4: 0,
          triBaseHeight: 0,
          quadBaseHeight: 0,
        });

        const [selectedCriteria, setSelectedCriteria] = React.useState([]);

        // Safe Value Helper (prevents NaN)
        const val = (v) => {
          const num = parseFloat(v);
          return isNaN(num) ? 0 : num;
        };

        const handleInputChange = (field, value) => {
          setFormData(prev => ({ ...prev, [field]: value }));
        };

        const handlePresetChange = (e) => {
          const presetId = e.target.value;
          const preset = PRESETS.find(p => p.id === presetId);
          if (!preset) return;

          if (presetId === 'custom') {
            setFormData(prev => ({ 
              ...prev, 
              preset: presetId, 
              weight: 0,
              length: 0, width: 0, height: 0,
              side: 0,
              baseEdge1: 0, baseEdge2: 0, baseEdge3: 0, baseEdge4: 0,
              triBaseHeight: 0, quadBaseHeight: 0
            }));
            setSelectedCriteria([]);
          } else {
            setFormData(prev => ({
              ...prev,
              preset: presetId,
              shape: preset.type,
              weight: preset.weight,
              length: preset.dims.l || 0,
              width: preset.dims.w || 0,
              height: preset.dims.h || 0,
              side: preset.dims.side || 0,
              // Reset specific prism fields just in case
              baseEdge1: 0, baseEdge2: 0, baseEdge3: 0, baseEdge4: 0,
              triBaseHeight: 0, quadBaseHeight: 0
            }));
          }
        };

        const toggleCriterion = (id) => {
          setSelectedCriteria(prev => 
            prev.includes(id) ? prev.filter(c => c !== id) : [...prev, id]
          );
        };

        const handleReset = () => {
          setFormData({
            preset: 'custom',
            occasion: 'none',
            shape: 'RECTANGULAR',
            weight: 0,
            length: 0, width: 0, height: 0,
            side: 0,
            baseEdge1: 0, baseEdge2: 0, baseEdge3: 0, baseEdge4: 0,
            triBaseHeight: 0, quadBaseHeight: 0
          });
          setSelectedCriteria([]);
        };

        // --- MATH LOGIC ---
        const calculateGeometry = () => {
          const { shape, length, width, height, side, baseEdge1, baseEdge2, baseEdge3, baseEdge4, triBaseHeight, quadBaseHeight } = formData;
          
          let V = 0, Sxq = 0, Stp = 0;

          if (shape === 'RECTANGULAR') {
            const l = val(length), w = val(width), h = val(height);
            V = l * w * h;
            Sxq = 2 * (l + w) * h;
            Stp = Sxq + 2 * (l * w);
          } else if (shape === 'CUBE') {
            const s = val(side);
            V = Math.pow(s, 3);
            Sxq = 4 * Math.pow(s, 2);
            Stp = 6 * Math.pow(s, 2);
          } else if (shape === 'TRI_PRISM') {
            // baseEdge1 = a, baseEdge2 = b, baseEdge3 = c. triBaseHeight = h_base. height = h_prism
            const a = val(baseEdge1), b = val(baseEdge2), c = val(baseEdge3);
            const h_base = val(triBaseHeight);
            const h_prism = val(height);
            
            const S_base = 0.5 * a * h_base;
            const P_base = a + b + c;
            
            V = S_base * h_prism;
            Sxq = P_base * h_prism;
            Stp = Sxq + 2 * S_base;
          } else if (shape === 'QUAD_PRISM') {
            // Trapezoid: a(bottom)=baseEdge1, b(top)=baseEdge2, c(left)=baseEdge3, d(right)=baseEdge4
            // h_base = quadBaseHeight, h_prism = height
            const a = val(baseEdge1), b = val(baseEdge2), c = val(baseEdge3), d = val(baseEdge4);
            const h_base = val(quadBaseHeight);
            const h_prism = val(height);

            const S_base = 0.5 * (a + b) * h_base;
            const P_base = a + b + c + d;

            V = S_base * h_prism;
            Sxq = P_base * h_prism;
            Stp = Sxq + 2 * S_base;
          }

          return {
            V: V.toFixed(1),
            Sxq: Sxq.toFixed(1),
            Stp: Stp.toFixed(1)
          };
        };

        const openReference = (platform) => {
          const shapeObj = SHAPES.find(s => s.id === formData.shape);
          const shapeKeyword = shapeObj ? shapeObj.keyword : 'gift box';
          const adjectives = selectedCriteria.map(id => CRITERIA.find(c => c.id === id)?.adj || '').join(' ');
          const baseQuery = `DIY ${adjectives} ${shapeKeyword} template`.replace(/\s+/g, ' ').trim();
          let url = '';
          const encodedQuery = encodeURIComponent(baseQuery);
          switch (platform) {
            case 'google': url = `https://www.google.com/search?q=${encodeURIComponent(baseQuery + " dieline vector")}&tbm=isch`; break;
            case 'pinterest': url = `https://www.pinterest.com/search/pins/?q=${encodedQuery}`; break;
            case 'youtube': url = `https://www.youtube.com/results?search_query=${encodeURIComponent("how to make " + baseQuery)}`; break;
            case 'behance': url = `https://www.behance.net/search/projects?search=${encodedQuery}`; break;
            case 'freepik': url = `https://www.freepik.com/search?format=search&query=${encodedQuery}`; break;
            case 'shutterstock': url = `https://www.shutterstock.com/search/${encodedQuery}`; break;
          }
          if (url) window.open(url, '_blank');
        };
        
        const openDecoration = (platform) => {
          const shapeName = SHAPES.find(s => s.id === formData.shape)?.keyword || 'gift box';
          const occasionObj = OCCASIONS.find(o => o.id === formData.occasion);
          const occasionKeywords = occasionObj ? occasionObj.keywords : 'gift';
          const occasionLabel = occasionObj ? occasionObj.label : 'gift';
          if (platform === 'google_images') {
             const query = `${shapeName} gift box decoration ${occasionLabel} ideas`;
             window.open(`https://www.google.com/search?q=${encodeURIComponent(query)}&tbm=isch`, '_blank');
          } else if (platform === 'youtube') {
             const query = `how to decorate ${shapeName} for ${occasionLabel} ${occasionKeywords}`;
             window.open(`https://www.youtube.com/results?search_query=${encodeURIComponent(query)}`, '_blank');
          } else if (platform === 'pinterest') {
             const query = `${shapeName} gift box decoration ${occasionLabel} ideas ${occasionKeywords}`;
             window.open(`https://www.pinterest.com/search/pins/?q=${encodeURIComponent(query)}`, '_blank');
          }
        };

        const getPaperSize = () => {
          const l = val(formData.length), w = val(formData.width), h = val(formData.height);
          const maxDim = Math.max(l, w, h);
          if (maxDim <= 29.7) return 'A3 (29.7x42cm)';
          if (maxDim <= 42) return 'A2 (42x59.4cm)';
          return 'Kh·ªï A0 ho·∫∑c gi·∫•y cu·ªôn l·ªõn';
        };

        const matAdvice = (() => {
           const isEco = selectedCriteria.includes('eco');
           if (isEco) return { paper: "Gi·∫•y E-co ho·∫∑c Gi·∫•y Kraft n√¢u.", gsm: "200-250gsm", reason: "Th√¢n thi·ªán m√¥i tr∆∞·ªùng." };
           return { paper: "Gi·∫•y Canson, M·ªπ thu·∫≠t ho·∫∑c Kraft.", gsm: "180-220gsm", reason: "D·ªÖ g·∫•p, gi·ªØ form t·ªët." };
        })();
        
        const geoCalc = calculateGeometry();

        // Paper Quantity Calculation
        const paperQuantity = (() => {
          const stp = parseFloat(geoCalc.Stp);
          if (stp <= 0) return 0;
          
          const sizeStr = getPaperSize();
          const areaRequired = stp * 1.2; // Add 20% wastage
          
          let sheetArea = 1247.4; // Default A3 area in cm2 (29.7 * 42)
          if (sizeStr.includes('A3')) sheetArea = 1247.4;
          else if (sizeStr.includes('A2')) sheetArea = 2494.8; // 42 * 59.4
          else if (sizeStr.includes('A0')) sheetArea = 9991.0; // Approx A0
          
          return Math.ceil(areaRequired / sheetArea) || 1;
        })();

        return (
          <div className="min-h-screen bg-slate-50 p-6 md:p-10 font-sans text-base">
            <div className="max-w-[1400px] mx-auto space-y-8">
              
              {/* Header */}
              <header className="flex items-center space-x-4 pb-6 border-b border-slate-200">
                <div className="p-3 bg-brand-600 rounded-xl text-white shadow-lg shadow-brand-500/30">
                  <Icon name="gift" size={32} />
                </div>
                <div>
                  <h1 className="text-3xl font-bold text-slate-800 tracking-tight uppercase">Tr·ª£ l√Ω AI h·ªó tr·ª£ x·∫øp h·ªôp qu√†</h1>
                  <p className="text-slate-500 text-lg">C√¥ng c·ª• h·ªó tr·ª£ thi·∫øt k·∫ø v·ªè h·ªôp qu√†</p>
                </div>
              </header>

              {/* Main Grid */}
              <div className="grid grid-cols-1 xl:grid-cols-3 gap-8">
                
                {/* COLUMN 1: Inputs */}
                <section className="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden flex flex-col h-full">
                  <div className="bg-slate-50 px-8 py-5 border-b border-slate-200 flex items-center space-x-3">
                    <Icon name="sliders" className="text-brand-600" size={24} />
                    <h2 className="font-bold text-slate-700 text-lg">Th√¥ng s·ªë h·ªôp qu√†</h2>
                  </div>
                  
                  <div className="p-8 space-y-6 flex-1 flex flex-col">
                    <div className="space-y-2">
                      <label className="block text-base font-medium text-slate-600">Lo·∫°i qu√† (Ch·ªçn m·∫´u c√≥ s·∫µn)</label>
                      <select value={formData.preset} onChange={handlePresetChange} className="w-full px-4 py-3 rounded-xl border border-slate-300 focus:border-brand-500 focus:ring-4 focus:ring-brand-100 outline-none bg-white text-base text-gray-900">
                        {PRESETS.map(p => <option key={p.id} value={p.id}>{p.name}</option>)}
                      </select>
                      <p className="text-xs text-gray-500 italic mt-1">Ch·ªçn lo·∫°i qu√† trong danh s√°ch ƒë·ªÉ AI t·ª± t√≠nh k√≠ch th∆∞·ªõc h·ªôp qu√† ho·∫∑c b·∫°n t·ª± ch·ªçn k√≠ch th∆∞·ªõc h·ªôp qu√†.</p>
                    </div>

                    <div className="space-y-2">
                      <label className="block text-base font-medium text-slate-600">Tr·ªçng l∆∞·ª£ng qu√† (gram)</label>
                       <input 
                         type="number" 
                         value={formData.weight === 0 ? '' : formData.weight} 
                         onChange={(e) => handleInputChange('weight', e.target.value)} 
                         placeholder="0"
                         className="w-full px-4 py-3 rounded-xl border border-slate-300 bg-white text-gray-900 focus:border-brand-500 focus:ring-4 focus:ring-brand-100 outline-none text-base"
                       />
                    </div>

                    <hr className="border-slate-100" />

                    <div className="space-y-3">
                      <label className="block text-base font-medium text-slate-600 flex items-center gap-2">
                        <Icon name="ruler" size={20} /> H√¨nh d·∫°ng h·ªôp qu√† mong mu·ªën
                      </label>
                      <select value={formData.shape} onChange={(e) => handleInputChange('shape', e.target.value)} className="w-full px-4 py-3 rounded-xl border border-slate-300 focus:border-brand-500 focus:ring-4 focus:ring-brand-100 outline-none bg-white font-medium text-brand-700 text-base text-gray-900">
                        {SHAPES.map(s => <option key={s.id} value={s.id}>{s.name}</option>)}
                      </select>
                    </div>

                    <div className="bg-slate-50 p-6 rounded-xl border border-slate-200 space-y-4">
                      <p className="text-sm font-bold text-slate-400 uppercase tracking-wider">K√≠ch th∆∞·ªõc h·ªôp qu√† mong mu·ªën (cm)</p>
                      {formData.shape === 'RECTANGULAR' && (
                        <div className="grid grid-cols-3 gap-4">
                          <DimInput label="D√†i (L)" val={formData.length} setter={(v) => handleInputChange('length', v)} />
                          <DimInput label="R·ªông (W)" val={formData.width} setter={(v) => handleInputChange('width', v)} />
                          <DimInput label="Cao (H)" val={formData.height} setter={(v) => handleInputChange('height', v)} />
                        </div>
                      )}
                      {formData.shape === 'CUBE' && (
                        <div className="grid grid-cols-1">
                          <DimInput label="C·∫°nh (Side)" val={formData.side} setter={(v) => handleInputChange('side', v)} />
                        </div>
                      )}
                      {formData.shape === 'TRI_PRISM' && (
                        <div className="space-y-4">
                          <div className="grid grid-cols-3 gap-3">
                            <DimInput label="C·∫°nh ƒë√°y (·ª©ng v·ªõi chi·ªÅu cao ƒë√°y)" val={formData.baseEdge1} setter={(v) => handleInputChange('baseEdge1', v)} />
                            <DimInput label="C·∫°nh ƒë√°y 2" val={formData.baseEdge2} setter={(v) => handleInputChange('baseEdge2', v)} />
                            <DimInput label="C·∫°nh ƒë√°y 3" val={formData.baseEdge3} setter={(v) => handleInputChange('baseEdge3', v)} />
                          </div>
                          <div className="grid grid-cols-2 gap-4">
                             <DimInput label="Chi·ªÅu cao ƒë√°y" val={formData.triBaseHeight} setter={(v) => handleInputChange('triBaseHeight', v)} />
                             <DimInput label="Chi·ªÅu cao lƒÉng tr·ª• ƒë·ª©ng" val={formData.height} setter={(v) => handleInputChange('height', v)} />
                          </div>
                        </div>
                      )}
                      {formData.shape === 'QUAD_PRISM' && (
                        <div className="space-y-4">
                          <div className="grid grid-cols-2 gap-4">
                            <DimInput label="ƒê√°y l·ªõn (Bottom)" val={formData.baseEdge1} setter={(v) => handleInputChange('baseEdge1', v)} />
                            <DimInput label="ƒê√°y nh·ªè (Top)" val={formData.baseEdge2} setter={(v) => handleInputChange('baseEdge2', v)} />
                            <DimInput label="C·∫°nh b√™n tr√°i (L)" val={formData.baseEdge3} setter={(v) => handleInputChange('baseEdge3', v)} />
                            <DimInput label="C·∫°nh b√™n ph·∫£i (R)" val={formData.baseEdge4} setter={(v) => handleInputChange('baseEdge4', v)} />
                          </div>
                          <div className="grid grid-cols-2 gap-4">
                             <DimInput label="Chi·ªÅu cao ƒë√°y" val={formData.quadBaseHeight} setter={(v) => handleInputChange('quadBaseHeight', v)} />
                             <DimInput label="Chi·ªÅu cao lƒÉng tr·ª• ƒë·ª©ng t·ª© gi√°c" val={formData.height} setter={(v) => handleInputChange('height', v)} />
                          </div>
                        </div>
                      )}
                    </div>

                    <button onClick={handleReset} className="w-full mt-6 py-2 px-4 border border-red-200 text-red-500 rounded-xl hover:bg-red-50 transition-colors flex items-center justify-center gap-2 text-sm font-bold">
                      <Icon name="trash" size={18} /> X√≥a l√†m l·∫°i
                    </button>
                  </div>
                </section>

                {/* COLUMN 2: Criteria & Materials */}
                <div className="flex flex-col gap-6 h-full">
                  <section className="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden flex flex-col">
                    <div className="bg-slate-50 px-8 py-5 border-b border-slate-200 flex items-center space-x-3">
                      <Icon name="check" className="text-brand-600" size={24} />
                      <h2 className="font-bold text-slate-700 text-lg">Ti√™u ch√≠ ∆∞u ti√™n</h2>
                    </div>
                    <div className="p-3">
                      <div className="space-y-2">
                        {CRITERIA.map(criterion => {
                          const isSelected = selectedCriteria.includes(criterion.id);
                          return (
                            <button key={criterion.id} onClick={() => toggleCriterion(criterion.id)} className={`w-full relative py-2 px-3 rounded-lg border text-left transition-all duration-200 flex items-center justify-between group ${isSelected ? 'border-brand-500 bg-brand-50 text-brand-700 shadow-sm' : 'border-slate-200 hover:border-brand-300 hover:bg-slate-50 text-slate-600'}`}>
                              <span className="font-medium text-sm md:text-base">{criterion.label}</span>
                              <div className={`w-5 h-5 rounded-full border flex items-center justify-center transition-colors ${isSelected ? 'bg-brand-500 border-brand-500' : 'border-slate-300 bg-white group-hover:border-brand-400'}`}>
                                {isSelected && <Icon name="check" className="text-white" size={12} />}
                              </div>
                            </button>
                          )
                        })}
                      </div>
                    </div>
                  </section>

                  {/* Materials Section */}
                  <section className="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden flex-1">
                    <div className="bg-slate-50 px-8 py-5 border-b border-slate-200 flex items-center space-x-3">
                      <Icon name="clipboard" className="text-brand-600" size={24} />
                      <h2 className="font-bold text-slate-700 text-lg">G·ª£i √Ω chu·∫©n b·ªã v·∫≠t li·ªáu</h2>
                    </div>
                    
                    <div className="p-8 space-y-5">
                       <div className="p-5 rounded-xl bg-blue-50 border border-blue-100 flex items-start gap-4">
                          <div className="p-2.5 bg-white rounded-lg shadow-sm text-blue-500 shrink-0">
                             <Icon name="image" size={24} />
                          </div>
                          <div>
                            <h3 className="text-base font-bold text-blue-900">üìÑ Lo·∫°i gi·∫•y khuy√™n d√πng:</h3>
                            <p className="text-base font-bold text-blue-700 mt-1">{matAdvice.paper}</p>
                            <p className="text-sm text-blue-600 italic mt-0.5">{matAdvice.reason}</p>
                            <div className="mt-2 flex flex-wrap gap-2">
                              <span className="inline-block px-2 py-1 bg-blue-100 text-blue-800 text-xs font-bold rounded">
                                ƒê·ªãnh l∆∞·ª£ng gi·∫•y: {matAdvice.gsm}
                              </span>
                              <span className="inline-block px-2 py-1 bg-blue-200 text-blue-800 text-xs font-bold rounded">
                                Kh·ªï gi·∫•y g·ª£i √Ω: {getPaperSize()}
                              </span>
                              {paperQuantity > 0 && (
                                <span className="inline-block px-2 py-1 bg-blue-200 text-blue-800 text-xs font-bold rounded">
                                  S·ªë l∆∞·ª£ng ∆∞·ªõc t√≠nh: {paperQuantity} t·ªù
                                </span>
                              )}
                            </div>
                            {selectedCriteria.includes('lid_base') && (
                               <p className="text-sm text-red-500 font-bold italic mt-2 border-t border-blue-200 pt-2">
                                 ‚ö† L∆∞u √Ω: ƒê√¢y l√† ki·ªÉu h·ªôp n·∫Øp √¢m d∆∞∆°ng (2 ph·∫ßn t√°ch bi·ªát). B·∫°n c·∫ßn t√≠nh to√°n gi·∫•y cho c·∫£ Th√¢n h·ªôp v√† N·∫Øp h·ªôp ri√™ng l·∫ª.
                               </p>
                            )}
                          </div>
                       </div>

                       <div className="p-5 rounded-xl bg-orange-50 border border-orange-100 flex items-start gap-4">
                          <div className="p-2.5 bg-white rounded-lg shadow-sm text-orange-500 shrink-0">
                             <Icon name="palette" size={24} />
                          </div>
                          <div>
                            <h3 className="text-base font-bold text-orange-900">üõ† Ph·ª• ki·ªán & D·ª•ng c·ª•</h3>
                            <ul className="text-sm text-orange-800 mt-1 list-disc list-inside space-y-1">
                              <li>Dao r·ªçc gi·∫•y, B√†n c·∫Øt (Cutting mat)</li>
                              <li><strong>Th∆∞·ªõc k·∫ª, Th∆∞·ªõc √™-ke</strong> (ƒë·ªÉ ƒëo g√≥c vu√¥ng)</li>
                              <li>Keo s·ªØa, BƒÉng keo 2 m·∫∑t, B√∫t ch√¨</li>
                              {selectedCriteria.includes('gable') && <li><strong>Ruy bƒÉng, D√¢y th·ª´ng</strong> (l√†m quai x√°ch)</li>}
                            </ul>
                          </div>
                       </div>
                    </div>
                  </section>
                </div>

                {/* COLUMN 3: Right Dashboard */}
                <div className="flex flex-col gap-6 h-full">
                  
                  {/* Reference Buttons */}
                  <section className="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden flex flex-col">
                    <div className="bg-indigo-50 px-8 py-5 border-b border-indigo-100 flex items-center space-x-3">
                      <Icon name="search" className="text-indigo-600" size={24} />
                      <h2 className="font-bold text-indigo-800 text-lg">H·ªôp qu√† v√† b·∫£n v·∫Ω tham kh·∫£o</h2>
                    </div>
                    <div className="p-8">
                      <div className="grid grid-cols-3 gap-4">
                        <RefButton label="Google" sub="T√¨m b·∫£n v·∫Ω" color="bg-blue-500 hover:bg-blue-600" icon="google" onClick={() => openReference('google')} />
                        <RefButton label="Pinterest" sub="√ù t∆∞·ªüng" color="bg-red-500 hover:bg-red-600" icon="pinterest" onClick={() => openReference('pinterest')} />
                        <RefButton label="YouTube" sub="H∆∞·ªõng d·∫´n" color="bg-red-600 hover:bg-red-700" icon="youtube" onClick={() => openReference('youtube')} />
                        <RefButton label="Behance" sub="Thi·∫øt k·∫ø" color="bg-blue-800 hover:bg-blue-900" icon="behance" onClick={() => openReference('behance')} />
                        <RefButton label="Freepik" sub="Vector" color="bg-purple-600 hover:bg-purple-700" icon="freepik" onClick={() => openReference('freepik')} />
                        <RefButton label="Shutterstock" sub="·∫¢nh m·∫´u" color="bg-orange-500 hover:bg-orange-600" icon="shutterstock" onClick={() => openReference('shutterstock')} />
                      </div>
                    </div>
                  </section>

                  {/* Decoration Suggestion */}
                  <section className="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
                     <div className="bg-pink-50 px-8 py-5 border-b border-pink-100 flex items-center space-x-3">
                       <Icon name="palette" className="text-pink-600" size={24} />
                       <h2 className="font-bold text-pink-800 text-lg">G·ª£i √Ω trang tr√≠ h·ªôp qu√†</h2>
                     </div>
                     <div className="p-8">
                        <div className="mb-6">
                           <label className="block text-base font-medium text-pink-800 mb-2">Ch·ªçn d·ªãp t·∫∑ng qu√† ƒë·ªÉ xem g·ª£i √Ω trang tr√≠:</label>
                           <select value={formData.occasion} onChange={(e) => handleInputChange('occasion', e.target.value)} className="w-full px-4 py-3 rounded-xl border border-pink-200 focus:border-pink-500 focus:ring-4 focus:ring-pink-100 outline-none bg-white text-base text-gray-900">
                            {OCCASIONS.map(o => <option key={o.id} value={o.id}>{o.label}</option>)}
                          </select>
                        </div>
                        <div className="grid grid-cols-3 gap-4">
                          <button onClick={() => openDecoration('google_images')} className="bg-blue-50 border-blue-100 text-blue-700 hover:bg-blue-100 hover:text-blue-800 border p-4 rounded-xl flex flex-col items-center justify-center gap-2 transition-all h-24">
                            <Icon name="search" size={24} className="text-blue-600" />
                            <div className="text-center"><span className="block text-sm font-bold">Google</span></div>
                          </button>
                          <button onClick={() => openDecoration('youtube')} className="bg-red-50 border-red-100 text-red-700 hover:bg-red-100 border p-4 rounded-xl flex flex-col items-center justify-center gap-2 transition-all h-24">
                            <Icon name="youtube" size={24} />
                            <div className="text-center"><span className="block text-sm font-bold">YouTube</span></div>
                          </button>
                          <button onClick={() => openDecoration('pinterest')} className="bg-red-50 border-red-100 text-red-800 hover:bg-red-100 border p-4 rounded-xl flex flex-col items-center justify-center gap-2 transition-all h-24">
                            <Icon name="pin" size={24} />
                             <div className="text-center"><span className="block text-sm font-bold">Pinterest</span></div>
                          </button>
                        </div>
                     </div>
                  </section>
                  
                  {/* NEW SECTION: Geometry Calculation */}
                  <section className="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
                     <div className="bg-teal-50 px-8 py-5 border-b border-teal-100 flex items-center space-x-3">
                       <Icon name="calculator" className="text-teal-600" size={24} />
                       <h2 className="font-bold text-teal-800 text-lg">Th√¥ng s·ªë h√¨nh h·ªçc (V, Sxq, Stp)</h2>
                     </div>
                     <div className="p-8">
                        <div className="grid grid-cols-3 gap-4 text-center">
                          <div className="p-4 bg-teal-50 rounded-xl border border-teal-100">
                             <p className="text-xs font-bold text-teal-600 uppercase mb-1">Th·ªÉ t√≠ch (V)</p>
                             <p className="text-xl font-bold text-teal-900">{geoCalc.V} <span className="text-sm font-normal">cm¬≥</span></p>
                          </div>
                          <div className="p-4 bg-teal-50 rounded-xl border border-teal-100">
                             <p className="text-xs font-bold text-teal-600 uppercase mb-1">Di·ªán t√≠ch XQ</p>
                             <p className="text-xl font-bold text-teal-900">{geoCalc.Sxq} <span className="text-sm font-normal">cm¬≤</span></p>
                          </div>
                          <div className="p-4 bg-teal-50 rounded-xl border border-teal-100">
                             <p className="text-xs font-bold text-teal-600 uppercase mb-1">Di·ªán t√≠ch TP</p>
                             <p className="text-xl font-bold text-teal-900">{geoCalc.Stp} <span className="text-sm font-normal">cm¬≤</span></p>
                          </div>
                        </div>
                     </div>
                  </section>

                </div>

              </div>
            </div>
          </div>
        );
      };

      const DimInput = ({ label, val, setter }) => (
        <div className="relative group">
          <label className="block text-xs text-slate-500 mb-1.5 font-bold uppercase group-focus-within:text-brand-600 transition-colors">{label}</label>
          <div className="relative">
            <input 
              type="number" 
              value={val === 0 ? '' : val} 
              onChange={(e) => setter(e.target.value)} 
              placeholder="0"
              className="w-full pl-4 pr-10 py-3 rounded-lg border border-slate-300 bg-white text-slate-900 text-base font-medium focus:border-brand-500 focus:ring-4 focus:ring-brand-100 outline-none shadow-sm transition-all" 
            />
            <span className="absolute right-3 top-3.5 text-sm text-slate-400 select-none font-medium">cm</span>
          </div>
        </div>
      );

      const RefButton = ({ label, sub, color, icon, onClick }) => (
        <button onClick={onClick} className={`${color} text-white p-2 rounded-xl shadow-md hover:shadow-lg hover:shadow-slate-300/50 transition-all transform hover:-translate-y-1 active:scale-95 flex flex-col items-center justify-center gap-1 h-24 w-full`}>
          <Icon name={icon} size={24} />
          <span className="text-sm font-bold">{label}</span>
          <span className="text-[10px] opacity-80 uppercase tracking-wide">{sub}</span>
        </button>
      );

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>